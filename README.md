# Exploit for CVE-2021-3560 (Polkit)
For educational and authorized security research purposes only.
```
                   _ __,~~~/_     ______   ______    ___  ___  ___ ___    ____ ____ ____ ___ 
               ,~~`( )_( )-\|    / ___/ | / / __/___|_  |/ _ \|_  <  /___|_  // __// __// _ \
                    |/|  `--.   / /__ | |/ / _//___/ __// // / __// /___//_ </__ \/ _ \/ // /
                    ! !  !      \___/ |___/___/   /____/\___/____/_/   /____/____/\___/\___/ 
```

**Like this repo? Give us a ⭐!**

## Exploit Author
[@UNICORDev](https://unicord.dev) by ([@NicPWNs](https://github.com/NicPWNs) and [@Dev-Yeoj](https://github.com/Dev-Yeoj))

## Vulnerability Description
It was found that polkit could be tricked into bypassing the credential checks for D-Bus requests, elevating the privileges of the requestor to the root user. This flaw could be used by an unprivileged local attacker to, for example, create a new local administrator. The highest threat from this vulnerability is to data confidentiality and integrity as well as system availability.

## Exploit Description
Use this exploit on a system with vulnerable Polkit software to add a new user with Sudo privileges. Specify a custom username and/or password as CLI arguments if desired.

## Usage
```bash
  python3 exploit-CVE-2021–3560.py [-u <username> -p <password>]
  python3 exploit-CVE-2021–3560.py -h
```

## Options
```bash
  -u    Custom username. Provide username to be created. (Optional)
  -p    Custom password. Provide password to be configured for user. (Optional)
  -h    Show this help menu.
```

## Download
[Download exploit-CVE-2021-3560.py Here](https://raw.githubusercontent.com/UNICORDev/exploit-CVE-2021-3560/main/exploit-CVE-2021%E2%80%933560.py)

## Exploit Requirements
- python3
- etc.

## Demo
GIF

## Tested On
Polkit Version 0.105 (Ubuntu 20.04.2 LTS)

## Applies To
Polkit Versions 0.0 - 0.118

## Test Environment
```bash
apt install X
```

## Credits
- https://nvd.nist.gov/vuln/detail/CVE-2021-3560
