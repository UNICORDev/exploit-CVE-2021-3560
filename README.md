# Exploit for CVE-2021-3560 (Polkit)
For educational and authorized security research purposes only.
```
    _ __,~~~/_     ______   ______    ___  ___  ___ ___    ____ ____ ____ ___ 
,~~`( )_( )-\|    / ___/ | / / __/___|_  |/ _ \|_  <  /___|_  // __// __// _ \
     |/|  `--.   / /__ | |/ / _//___/ __// // / __// /___//_ </__ \/ _ \/ // /
     ! !  !      \___/ |___/___/   /____/\___/____/_/   /____/____/\___/\___/ 
```

**Like this repo? Give us a ⭐!**

## Exploit Author
[@UNICORDev](https://unicord.dev) by ([@NicPWNs](https://github.com/NicPWNs) and [@Dev-Yeoj](https://github.com/Dev-Yeoj))

## Vulnerability Description
It was found that polkit could be tricked into bypassing the credential checks for D-Bus requests, elevating the privileges of the requestor to the root user. This flaw could be used by an unprivileged local attacker to, for example, create a new local administrator. The highest threat from this vulnerability is to data confidentiality and integrity as well as system availability.

## Exploit Description
Our description.

## Usage
```bash
  python3 exploit-CVE-2021-22204.py -c <command>
  python3 exploit-CVE-2021-22204.py -s <local-IP> <local-port> [-i <image.jpg>]
  python3 exploit-CVE-2021-22204.py -h
```

## Options
```bash
  -c    Custom command mode. Provide command to execute.
  -s    Reverse shell mode. Provide local IP and port.
  -i    Path to custom JPEG image. (Optional)
  -h    Show this help menu.
```

## Download
[Download exploit-CVE-XXXX-XXXXX.py Here](https://raw.githubusercontent.com/UNICORDev/exploit-CVE-XXXX-XXXXX/main/exploit-CVE-XXXX-XXXXX.py)

## Exploit Requirements
- python3
- etc.

## Demo
GIF

## Tested On
Platform Version 0.0.0

## Applies To
Platform Versions 0.0.0 - 0.0.0

## Test Environment
```bash
apt install X
```

## Credits
- https://nvd.nist.gov/vuln/detail/CVE-2021-3560
- https://app.hackthebox.com/machines/paper
